# @strudel/locale

Locale and aliasing support for the Strudel live coding environment.

The `@strudel/locale` package enables you to use Strudel's pattern language in your preferred natural (or unnatural) language by providing aliases for function and method names.

## Features

- Locale-based Aliasing: Map Strudel function and method names to any language using simple JSON files with `alias`.
- Dynamic Locale Switching: Instantly switch languages in the REPL with `locale`.
- Batch and Flexible Aliasing: Support for single, multiple, and dictionary-based aliasing.
- Extensible: Add new languages by creating a locale file.
- Template Generation: Generate a complete locale file template with all available Strudel functions.
 
## Future work

- Aliasing for default samples and synths
- Aliasing for colours
- Aliasing for options (e.g. `pianoroll({fold: ..})`)
- Expand the package to include translations of function/method descriptions and other fields in `doc.json`
- Expand to include translation of the entire Strudel REPL UI including Settings etc.

## Usage

### 1. Simple Customised Aliasing

You can use the underlying `alias` function directly (from `@strudel/core/pattern.mjs`) to provide synonyms for individual terms:

```js
alias('fast', 'schnell') // Single alias
alias(['fast', 'slow'], ['vite', 'lent']) // Multiple aliases
alias({ fast: ['rapide', 'schnell'], slow: 'lent' }) // Dictionary
```

### 2. Create a Locale File

To add a persistent and easy to use locale file, add a JSON file in `strudel/packages/locale/locales/` for your language. For example, `de.json` for German:

```json
{
  "fast": "schnell",
  "slow": "langsam"
}
```

You can also alias to multiple terms as it uses `alias` underneath:

```json
{
  "fast": ["schnell", "rapide"],
  "slow": ["langsam", "lent"]
}
```

### 3. Set the Locale in the REPL

```js
// Load and apply the German locale
await locale("de")

s("bd cp").schnell(2) // equivalent to fast(2)
s("bd cp").langsam(0.5) // equivalent to slow(0.5)
```

- `locale(language)` loads `strudel/packages/locale/locales/<language>.json` and applies all aliases.
- Aliases work for both pattern methods and standalone functions.

### 4. Generating a Locale File Template

To help translators and contributors, the package provides a script to automatically generate a template JSON file listing all user-facing Strudel function names (including synonyms). This makes it easy to start a new translation.

#### 1. Prerequisite: Generate `doc.json`

The script relies on a documentation file (`doc.json`) generated by JSDoc.  
First, run:

```sh
pnpm jsdoc-json
```

This will create a `doc.json` file in the project root, containing all documented Strudel functions and their synonyms.

#### 2. Run the Template Generator

From the project root, run:

```sh
node packages/locale/script/generate-locale-template.mjs > packages/locale/locales/<your-language>.json
```

For example, to create a French template:

```sh
node packages/locale/script/generate-locale-template.mjs > packages/locale/locales/fr.json
```

#### 3. Fill in the Translations

Open the generated file (e.g., `fr.json`) and fill in the translations for each function name:

```json
{
  "fast": "rapide",
  "slow": "lent",
  "density": "densit√©"
  // ...etc.
}
```
